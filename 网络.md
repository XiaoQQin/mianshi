## 1. OSI与TCP/IP网络模型
### 1.1 OSI七层模型
![osi七层模型](https://user-gold-cdn.xitu.io/2019/8/31/16ce7c55e2003c1b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)  
### 1.2 TCP/IP五层模型  
其实TCP/IP只有4层，包括：**应用层、传输层、网络互连层、网络链接层**，但是综合OSI七层模型，我们一般称作5层，所以平时称TCP/IP五层模型也没错。  
![tcp/ip五层模型](https://user-gold-cdn.xitu.io/2019/8/31/16ce7e7fe7d7c181?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)  
  
- **应用层**:为应用程序提供网络服务。在互联网中应用层协议很多，如域名系统**DNS**，支持万维网应用的**HTTP协议**，支持电子邮件的**SMTP协议**等等。我们把应用层交互的数据单元称为**报文**。 
  

- **传输层**:负责向两台主机进程之间的通信提供通用的数据传输服务,也就是我们所说的端对端传输。  
   运输层主要使用以下两种协议：  
      - **TCP**：提供面向连接的，可靠的数据传输服务。  
      - **UDP**：提供无连接的，尽最大努力的数据传输服务（不保证数据传输的可靠性）。
  
- **网络层**：网络层的任务就是选择合适的网间路由和交换结点， 确保数据及时传送。也就是ip寻址、路由选择和数据传输。网络层把运输层产生的报文段或用户数据报封装成分组和包进行传送。由于网络层使用 IP 协议，因此分组也叫 IP 数据报 ，简称 数据报。  
  
- **数据链路层**： 控制网络层和物理层之间的通信，提供介质访问和链路管理。物理寻址，将原始比特流传输转变为逻辑传输路线。  
  
- **物理层**: 原始比特流的传输
  
### 网络模型的设备和协议  
在网络模型的每一层都工作着不同的设备，，如下图所示：  
![设备工作](https://user-gold-cdn.xitu.io/2019/8/31/16ce7eb72c0dc44c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)  
  
每一层的主要协议如下所示：  
  
![协议](https://user-gold-cdn.xitu.io/2019/8/31/16ce7ee86d166933?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)  
  
通常需要注意以下协议；  
- **HTTP、HTTPS在应用层**
- **TCP、UDP在传输层**  
- **IP在网络层**
  
    
[JavaGuide/计算机网络](https://github.com/Snailclimb/JavaGuide/blob/master/docs/network/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.md)        
[网络模型--OSI & TCP/IP](https://juejin.im/post/5d398dc26fb9a07ecb0bedde)
  
  
## 2. TCP三次握手与四次挥手
### 2.1 TCP三次握手  
    
![三次握手.PNG](https://i.loli.net/2020/05/04/1kURADPvgrYObF2.png)
![TCP三次握手](https://camo.githubusercontent.com/f6dfce1f05e95f94dbcc4b0bee8c4e3acbfb9f30/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392f372f254534254238253839254536254143254131254536253846254131254536253839253842322e706e67)  
  
**简单描述**:  
  
  - 客户端发送带有**SYN**标志的数据包，一次握手  
  - 服务器发送带有**SYN/ACK**标志的数据包，二次握手  
  - 客户端发送带有**ACK**标志的数据包，三次握手  
  
#### 为什么要三次握手？  
  
三次握手的目的是建立可靠的通信信道,三次握手就是双方确认自己与对方的发送与接收是正常的。  
  
- 第一次握手：Client 什么都不能确认；Server 确认了对方发送正常，自己接收正常
- 第二次握手：Client 确认了：自己发送、接收正常，对方发送、接受正常；Server确认了：对方发送正常，自己接受正常  
- 第三次握手：Client 确认了：自己发送、接收正常，对方发送、接受正常：Server确认了：对方发送正常、接收正常，自己发送、接受正常。  
  
 所以三次握手就能确认客户端和服务器收发功能都正常，缺一不可。  
   
#### 第2次握手传回了ACK，为什么还要传回SYN？  
服务器回传给客户端SYN是为了**建立并确认从服务端到客户端的通信**。  

#### 两次握手会怎么样？  
有这样一种情况，当A发送一个消息给B，但是由于网络原因，消息被阻塞在了某个节点，然后阻塞的时间超出设定的时间，A会认为这个消息丢失了，然后重新发送消息。 
    
 
当A和B通信完成后，这个被A认为失效的消息，到达了B。对于B而言，以为这是一个新的请求链接消息，就向A发送确认;对于A而言，它认为没有给B再次发送消息（因为上次的通话已经结束）所有A不会理睬B的这个确认，但是B则会一直等待A的消息。  
这就导致了B的时间被浪费（对于服务器而言，CPU等资源是一种浪费），这样是不可行的，这就是为什么不能两次握手的原因了。

二次握手会出现**已失效的请求报文段突然又传送到了服务端而产生连接的误判**的情况。三次握手就是防止已失效的请求报文段突然又传送到了服务端而产生连接的误判，也就是防止服务器资源因为错误数据而一直等待，浪费资源。
[TCP为什么是三次握手和四次挥手](https://blog.csdn.net/yu876876/article/details/81560122)
### 2.2 四次挥手  
![四次挥手.png](https://i.loli.net/2020/05/04/yAmKi32XvsnSJHz.png)    
![四次挥手](https://camo.githubusercontent.com/66e3447783e22d736f7db9c7d121e8eba54f07c0/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392f372f5443502545352539422539422545362541432541312545362538432541352545362538392538422e706e67)
  
**简要描述**：  
  - 客户端发送一个**FIN**，用来关闭客户端到服务器的数据传输  
  - 服务器接收到这个**FIN**,他发回一个**ACK**，确认的序号为收到的序号加1。  
  - 服务器关闭与客户端的链接，发送一个**FIN**给客户端  
  - 客户端发回**ACK**报文确认，确认序号设置为收到序号加1。  
    
 #### 为什么要四次挥手？  
TCP是全双工模式，客户端和服务器都可以发送和接受数据。这就意味着，当客户端发出FIN报文段时，只是表示客户端已经没有数据要发送了，客户端告诉服务器，它的数据已经全部发送完毕了；但是，这个时候客户端还是可以接受来自服务器的数据；当服务器返回ACK报文段时，表示它已经知道客户端没有数据发送了，但是服务器还是可以发送数据到客户端的；当服务器也发送了FIN报文段时，这个时候就表示服务器也没有数据要发送了。  
  
  
## 3. TCP和UDP协议的区别  
![tcp和udp的区别](https://camo.githubusercontent.com/582cf0bd58f1b7859ff7696d0345200d133bee88/68747470733a2f2f6d792d626c6f672d746f2d7573652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f323031392d31312f7463702d76732d7564702e6a7067)
- TCP是面向连接，可靠传输的;UDP是面向无连接，传输不可靠的。  
- TCP传输效率更慢，UDP传输更快  
- TCP一般应用在要求数据传输可靠的场景，比如邮件传输，远程登录；UDP一般应用在要求传输速度快的场景，比如视频会议，语音通话。  
  
## 4. 从输入URL到页面加载发生了什么  
- **DNS解析**:DNS解析的过程就是寻找哪台机器上有你需要资源的过程，实现了网址到IP地址的转换,DNS解析是一个递归查询的过程。  
- **TCP连接**: 三次握手  
- **发送HTTP请求**  
- **服务器处理请求并返回HTTP报文**  
- **浏览器解析渲染页面**
- **连接结束**  
  
具体请看：[前端经典面试题: 从输入URL到页面加载发生了什么？](https://segmentfault.com/a/1190000006879700)  
  
## 5. Cookie和Session  
  
-  Cookie一般用来保存**用户信息** 比如我们在Cookie 中保存已经登录过得用户信息，下次访问网站的时候页面可以自动帮你登录的一些基本信息给填了；Session 的主要作用就是**通过服务端记录用户的状态**。 典型的场景是购物车，当你要添加商品到购物车的时候，系统不知道是哪个用户操作的，因为 HTTP 协议是无状态的。服务端给特定的用户创建特定的 Session 之后就可以标识这个用户并且跟踪这个用户了。  
-  Cookie 数据保存在**客户端(浏览器端)**，Session 数据保存在**服务器端**。  
-  Session的运行依赖于
